# Claude-Code Agent 与 Gemini 协同工作

## 简介

本工作流适用于基于需求文档的 Python 软件开发和人在回路的代码审查。

## 环境与软件要求

### 环境
*   macOS & Linux 终端 (包括 WSL)

### 软件
*   `claude-code`
*   `gemini-cli`

## 使用方法

1.  **在 `claude-code` 中设置 Agent**:
    *   在 `claude-code` 中，使用 `/sub-agent` 命令导入本仓库中的 `claude-*.md` 模板来引导创建 agent。
    *   或者，将 `claude-*.md` 模板的内容设置为您 `CLAUDE.MD` 的基础内容。

2.  **在 `gemini-cli` 中设置 Agent**:
    *   在初始化并登录 `gemini-cli` 后，导入本仓库中的 `gemini-*.md` 模板。这将要求 Gemini 根据提示词模板中设定的身份与 `claude-code` 进行协作。

3.  **协作流程**:
    *   在协作过程中，使用统一的 `@+文件名` 语法来对齐两个 CLI 中 agent 的上下文颗粒度，确保没有任何过时信息。
    *   在修改期间，要保持任务规划文档的实时更新。

4.  **模型角色**:
    *   由于 Gemini 2.5 Pro 并未针对 agent 能力进行特别训练，我们利用其 1M token 的长上下文能力来承担代码审查和提出解决方案的环节，只让具有 200K 上下文的 Claude 模型专注于任务的执行。

## 工作流程

在按上述步骤初始化 agent 后，用户必须扮演**人在回路的审查角色**。您需要负责手动审查、复制和粘贴 Claude 与 Gemini 之间的通信（例如，从 Claude 到 Gemini 的汇报，或从 Gemini 到 Claude 的建议）。这确保了两个模型之间的通信符合您的期望，并避免了因让大语言模型自主决策而可能导致的短视效应。

## 核心思想

1.  **规避 LLM 的局限性**:
    由于 LLM 底层数学规律的缺陷可能导致错误复合效应和上下文窗口限制，本工作流避免使用单一模型来完成完整的“代码审查-代码修改”循环。反之，它引入了 Gemini 的长上下文能力，以尽量减少因上下文窗口限制导致的信息丢失，并降低因平方成本诅咒（quadratic cost curse）而产生的高昂 API 使用费用。

2.  **发挥各自优势**:
    `claude-code` 环境及其完整的工具生态系统，是与 **Claude 4** 模型系列的训练紧密结合的。这使得 **Claude 4** 系列成为目前在“vibe coding”领域最强大的 agent。结合我个人使用 Cursor、Augment 等软件的实际体验，可以说，目前提出的这套方案是实践中门槛最低，并且能够切实完成代码重构等复杂任务的最优解。

## 联系与反馈

如果您有任何建议或疑问，欢迎在本仓库中提出 issue，或联系 `2217173240@qq.com`（请勿发送 QQ 好友请求）。
